This file lists the change logs applicable to version 2.2.2 made since the
2.2.1 release.
	
samples/inncheck.in:
	- From: Wolfgang Breyha <wbreyha@gmx.net>
	- The "inncheck" Util doesn't check for lines of the style "%DEFINEx:"
	  in nnrp.access.

innd/art.c:
	- previous patch still does not fix the problem which leads innd
	  dumping core

innd/art.c:
	- From: Don Lewis <Don.Lewis@tsc.tdk.com>
	- There's a bug in the ARTpost() function - when it sees an article
	  with a distribution header such as "Distribution: ," (note the
	  comma), the DISTparse() function returns a distribution[] array with
	  a null pointer as it's first element (i.e., an empty list). The later
	  call to MaxLength() in the arguments to sprintf() dereferences this
	  and dies in flames.

doc/innfeed.1:
doc/innfeed.conf.5:
	- drop beta description

README:
	- drop beta description

	Add documentation of innflags in inn.conf and of the syntax of
	incoming.conf.  By Richard Kettlewell <richard.kettlewell@kewill.com>.

samples/innreport_inn.pm:
	- From: Michael Hall <mhall@riverside.org>
	- fixes the error that says "Use of uninitialized value at ..."

nnrpd/udp.c:
	- fix for ULTRIX (strdup() does not exist)

frontends/innconfval.c:
	- fix for ULTRIX (strdup() does not exist)

backends/inndf.c:
	- From: Hiroshi MIZOGUCHI <mizoguti@screen.co.jp>
	- patch to make ULTRIX work

	Add support for alphaev6.

lib/endian.c:
	- From: Hiroshi MIZOGUCHI <mizoguti@screen.co.jp>
	- fixed for ULTRIX

innd/art:c
	- check of path in ListHas() was incorrect

nnrpd/misc.c:
	- From: Russell Vincent <russellv@uk.uu.net>
	- broken newnews (y2k problem) fixed

samples/innreport.in:
	- From: David Shrimpton <shrimpto@its.uq.edu.au>
	- If you set cycle to other than none , eg 7 in innreport.conf then
	  index.html is missing all the daily reports that are listed in
	  innreport.db

samples/pgpverify.in:
	- From: David Shrimpton <shrimpto@its.uq.edu.au>
	- Bug in errmsg subroutine in pgpverify which causes pgpverifies to be
	  syslogged with undefined facility

backends/batcher.c:
	- From: David Shrimpton <shrimpto@its.uq.edu.au>
	- "Reading config from /usr/local/news/etc/inn.conf" messages to be
	  syslogged with undefined facility.

samples/innshellvars.pl.in:
samples/innshellvars.tcl.in:
	- delete useless variable

	The innreport.conf setting for graph was ignored.

	Typo in openlog().

	The fcntl() flag is F_SETFD, not FD_SETFD.

frontends/sm.c:
	- do not call SMinit() if there is no token in arguments

samples/cnfsstat.in:
	- skip if no article is stored

samples/control.ctl:
	- add drop entry for PGP signed hierarchy

	Use space instead of tab after To: to work around a bug in Solaris
	sendmail.

innd/art.c:
	- From: Sven Paulus <sven@karlsruhe.org>
	- innd may dump core when copying Bytes header

innd/nc.c:
	- From: Heiko Schlichting <inn-bugs@fu-berlin.de>
	- When streaming is enabled and INN gets a NNTP "check" command WITHOUT
	  a following space/tab and message-id, it prints some memory dump to
	  the requestor

innd/status.c:
	- From: Heiko Schlichting <inn-bugs@fu-berlin.de>
	- inn crashes immediately if status was enabled and the compile-time
	  "MAX_PEER" limit is reached

samples/innreport_inn.pm:
	- 'ME' was included for innfeed stats

nnrpd/post.c:
	- '\r' was lost, if header is folded

innd/chan.c:
	- From: rmtodd@skywalker.ecn.ou.edu (Richard Todd)
	- This patch clears cp->In.Data and cp->Out.Data after the data they
	  point to are freed in CHANclose, thus making sure that we don't try
	  to free the same data again in CHANshutdown, thus littering the
	  errlog with
	    innd in free(): warning: page is already free.
	  warnings from the malloc/free code.

samples/innreport_inn.pm:
	- cancel message which recorded as 'c' was counted twice (also recorded
	  as '+') ($inn_flow_total was incorrectly incremented)

	Fix typo causing make distclean not to remove include/autoconfig.h.

	Use ppport.h for cross-version Perl compatibility rather than
	individual #define's in each file.  Also convert the last few
	occurances of na to PL_na and remove some duplicate #include's.

	Rename include/patchlevel.h to include/innversion.h to avoid conflicts
	with Perl header files.

doc/newsfeeds.5:
	- description of ME/exclude was dropped

doc/Makefile:
	- mod-active.8 and simpleftp.1 were still not installed

	mod-active.8 was missing from the list of man pages.  Reported by John
	Summerfield <summer@OS2.ami.com.au>.

innd/art.c:
	- replic data was broken if storage api and xrefslave is true
innd/innd.h:
innd/status.c:
	- Size may be overflow

frontends/inews.c:
	- From: Steve Campbell <steve@avalon.Dartmouth.EDU>
	- the comparison of mail address should be case-insensitive

samples/innreport_inn.pm:
	- still did not calculate outgoing feed correctly

samples/innreport_inn.pm:
	- innreport should see 'global' log message, or outgoing feed is much
	  less than reality

innd/chan.c:
	- paused connection might not be revived correctly when another active
	  connection is closed

innfeed/host.c:
	- fixed a problem that 'final' stats was not out if the connection
	  is vanished

innd/chan.c:
innd/innd.h:
innd/rc.c:
	- 'max-connections' in incoming.conf was effective on each IP address,
	  not each label

backends/batcher.c:
	- From: KIZU takashi <kizu@ics.es.osaka-u.ac.jp>
	- still had a bug, and fixed it

backends/batcher.c:
	- From: KIZU takashi <kizu@ics.es.osaka-u.ac.jp>
	- If any batch file is not opend yet and some kind of signals is
	  trapped, the function RequeueAndExit(-1, NULL, 0L) will be called and
	  the top line in a queue file will be lost.

	  If (BytesInBatch > 0 && BytesInCB + BytesInArt >= BytesInBatch) and
	  (MaxBytes > 0 BytesWritten + BytesInArt >= MaxBytes), then `while
	  (fgets...)' loop is breaked. But the function BATCHclose(F) usually
	  returns 0. Hence `Cookie' is ignored in the function RequeueAndExit().

innd/nc.c:
	- reported by Paul Tomblin <ptomblin@xcski.com>
	- 'internal rejecting huge article ..' should not be informed as L_ERROR

innd/art.c:
	- reported by Paul Gamble <paul@saix.net>
	- the Xref header in the article as it appears on the reader server
	  contains the reader's hostname and not the transit server's
	  in slave mode

samples/parsecontrol.in:
	- From: YOKOTA yoshinori <yokota@yynet.tama.tokyo.jp>
	- gnu sed was failed to parse

frontends/inews.c:
	- From: Russell Vincent <russellv@uk.uu.net>
	- missing '\n' in a couple of error reports

	Clean up the environment initialization and fix a potential buffer
	overflow reported by Stan Bubrouski <SB@MailAndNews.com>.  Allocate
	memory for each environment variable in-place without copying things
	through a buffer.

configure:
configure.in:
	- From: "Boyd Lynn Gerber (801) 250-O795 Work" <gerberb@zenez.com>
	- Patch for configure.in for SCO OpenServer 5.0.X and UnixWare 7.1.0

samples/nntpsend.in:
	- From: Russell Vincent <russellv@uk.uu.net>
	- prevent nntpsend from overwriting its own batches when using
	  storageapi and under certain circumstances (most likely when
	  innxmit to a site isn't running and there is already a backlog).

README:
	- From: ambar@clock.org
	- typo fixed

nnrpd/article.c:
	- reported by Damien Masse <masse@clipper.ens.fr>
	- I found this bug in INN version 2.2 (and version 2.1) :
	  when you ask for the last header of the overview file with the 'xhdr'
	  command, nnrp displays each header followed by a "\n<number> ".

nnrpd/perl.c:
	- From: Jan-Erik Eriksson <jee@alcom.aland.fi>
	- Using the --with-perl on inn-2.2.1 (RedHat 5.2, perl5.00405) will
	  cause make to fail.

lib/perl.c:
	- From: Jan-Erik Eriksson <jee@alcom.aland.fi>
	- Using the --with-perl on inn-2.2.1 (RedHat 5.2, perl5.00405) will
	  cause make to fail.

innd/cc.c:
innd/perl.c:
	- From: Jan-Erik Eriksson <jee@alcom.aland.fi>
	- Using the --with-perl on inn-2.2.1 (RedHat 5.2, perl5.00405) will
	  cause make to fail.

nnrpd/newnews.c:
	- '>' was missed for the response


Local Variables:
mode: text
End:
