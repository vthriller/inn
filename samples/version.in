#!@_PATH_SH@
##  $Revision$
##  Version control-message handler
. @LIBDIR@/innshellvars

PROG=version
##  Some shells don't pass in $* unless we explicitly pass it in here.
. ${PATHBIN}/parsecontrol "$@"

VERSION="INN 2.1"

WHERE=`innconfval pathhost`

SUBJECT="Version reply from `innconfval pathhost`"
case ${ACTION} in
mail)
    export FROM VERSION MAILCMD SUBJECT ARTICLE
    (
	echo "${FROM} requested your news version."
	echo 'To reply, do the following:'
	echo "	echo InterNetNews ${VERSION} | ${MAILCMD} -s \"${SUBJECT}\" ${FROM}"
	echo 'The full article was:'
	${SM} ${ARTICLE}
    ) | sed -e 's/^~/~~/' | ${MAILCMD} -s "version by ${FROM}" ${NEWSMASTER}
    ;;
logit)
    ${SM} ${ARTICLE} | ${WRITELOG} ${LOGFILE} "version by ${FROM}; reply skipped"
    ;;
doit)
    echo "InterNetNews ${VERSION}" | ${MAILCMD} -s "${SUBJECT}" ${REPLYTO}
    ${SM} ${ARTICLE} | ${WRITELOG} ${LOGFILE} "version by ${FROM}; reply sent"
    ;;
esac

exit
